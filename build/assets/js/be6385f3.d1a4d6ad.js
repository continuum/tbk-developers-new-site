"use strict";(self.webpackChunktbk_developers=self.webpackChunktbk_developers||[]).push([[8228],{49680:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>b,contentTitle:()=>p,default:()=>k,frontMatter:()=>m,metadata:()=>u,toc:()=>y});var i=o(87462),r=(o(67294),o(3905)),t=o(26389),n=o(94891),s=(o(75190),o(47507)),c=o(24310),d=o(63303),l=(o(75035),o(85162));const m={id:"autorizar-una-transaccion",title:"Autorizar una transacci\xf3n",description:"Con el tbkUser retornado de la confirmaci\xf3n (PUT /inscriptions/{token}) puedes autorizar transacciones Una vez que ya tienes la tarjeta del usuario inscrita (ya tienes el token tbk_user para ese usuario), puedes realizar cargos a esa tarjeta en cualquier momento, solo llamando a este m\xe9todo de autorizaci\xf3n, enviando el tbk_user, el username del usuario, un identificador de compra parentBuyOrder y los datos de la transacci\xf3n.",sidebar_label:"Autorizar una transacci\xf3n",hide_title:!0,hide_table_of_contents:!0,api:{tags:["Oneclick Mall"],description:'Con el tbkUser retornado de la confirmaci\xf3n (PUT /inscriptions/{token}) puedes autorizar transacciones Una vez que ya tienes la tarjeta del usuario inscrita (ya tienes el token tbk_user para ese usuario), puedes realizar cargos a esa tarjeta en cualquier momento, solo llamando a este m\xe9todo de autorizaci\xf3n, enviando el tbk_user, el username del usuario, un identificador de compra parentBuyOrder y los datos de la transacci\xf3n.\nComo Oneclick opera en modalidad Mall, en una misma autorizaci\xf3n puedes realizar varios cobros, cada uno a c\xf3digos de comercio tienda diferente. No olvidar que para realizar el cargo correctamente, esos c\xf3digo de comercio tienda deben "pertenecer" o estar asociados a tu c\xf3digo de comercio Mall cuando se contratan. Al tarjetahabiente se le realizar\xe1 un solo cobro por la suma del monto de todas las "sub-transacciones" solicitadas, pero el dinero ser\xe1 procesado y enviado a cada c\xf3digo de comercio por separado. Para aclararlo con un ejemplo, si solicito una autorizaci\xf3n por $1.500 para el comercio A, y $2.500 para el comercio B, el tarjetahabiente ver\xe1 un \xfanico cobro de $4.000 en su cartola, pero el comercio A recibir\xe1 los $1.500 y el comercio B los $2.500 (en ambos casos, restando la comisi\xf3n).\nCada "sub-transacci\xf3n" de la autorizaci\xf3n requiere de un c\xf3digo de comercio, un identificador de compra (ojal\xe1 \xfanico y diferente al identificador de compra padre), un monto y, opcionalmente, el n\xfamero de cuotas en que se realizar\xe1 el cobro.\nTip Para pruebas en el ambiente de integraci\xf3n te recomendamos crear un identificador \xfanico buy_order para cada una de las transacciones. (Ejemplo buy_order = nombre-de-mi-empresa-mall-1234, child_buy_order = nombre-de-mi-tienda-1).',requestBody:{content:{"application/json":{schema:{type:"object",properties:{username:{type:"string",description:"Identificador del usuario en los sistemas del comercio (el mismo indicado en Inscription.start()). Largo m\xe1ximo 40.",maxLength:40},tbk_user:{type:"string",description:"Identificador u\u0301nico de la inscripcio\u0301n del cliente (devuelto por Inscription.finish()). Largo 40.",minLength:40,maxLength:40},buy_order:{type:"integer",description:"Identificador u\u0301nico de la compra generado por el comercio. Largo m\xe1ximo 26."},details:{type:"array",description:"Lista de objetos, uno por cada tienda diferente del mall que participa en la transacci\xf3n.",items:{type:"object",properties:{commerce_code:{type:"string",description:"Co\u0301digo comercio asignado por Transbank para la tienda perteneciente al mall a la cual corresponde esta transacci\xf3n. Largo 12.",minLength:12,maxLength:12},buy_order:{type:"string",description:"Orden de compra de la tienda del mall. Este nu\u0301mero debe ser u\u0301nico para cada transaccio\u0301n. Largo ma\u0301ximo 26. La orden de compra puede tener Nu\u0301meros, letras, mayu\u0301sculas y minu\u0301sculas, y los signos |_=&%.,~:/?[+!@()>-.",maxLength:26},amount:{type:"number",description:"Monto de la transaccio\u0301n. Ma\u0301ximo 2 decimales para USD. Largo ma\u0301ximo 17",format:"float"},installments_number:{type:"integer",description:"Cantidad de cuotas de la transaccio\u0301n de pago. Largo 2. No obligatorio.",maximum:100}}}}},example:{username:"juanperez",tbk_user:"b6bd6ba3-e718-4107-9386-d2b099a8dd42",buy_order:"ordenCompra123456789",details:[{commerce_code:"597055555542",buy_order:"ordenCompra123445",amount:1e3,installments_number:5}]}}}},required:!0},responses:{200:{description:"(OK) La informacion de la inscripcion autorizada",content:{"application/json":{schema:{type:"object",properties:{buy_order:{type:"string",description:"Orden de compra generada por el comercio padre."},card_detail:{type:"array",description:"Objeto que contiene informaci\xf3n de la tarjeta utilizado por el tarjetahabiente.",items:{type:"object",properties:{"card_detail.card_number":{type:"string",description:"Los u\u0301ltimos 4 di\u0301gitos de la tarjeta usada en la transacci\xf3n."}}}},accounting_date:{type:"string",description:"Fecha contable de la autorizacio\u0301n del pago."},transaction_date:{type:"string",description:"Fecha completa (timestamp) de la autorizacio\u0301n del pago. Largo: 24, formato: ISO 8601 (Ej: yyyy-mm-ddTHH:mm:ss.xxxZ)"},details:{type:"array",description:"Lista con el resultado de cada transacci\xf3n de las tiendas hijas.",items:{type:"object",properties:{amount:{type:"number",description:"Monto de la sub-transaccio\u0301n de pago",format:"float"},status:{type:"string",description:"Estado de la transaccio\u0301n (INITIALIZED, AUTHORIZED, REVERSED, FAILED, NULLIFIED, PARTIALLY_NULLIFIED, CAPTURED)."},authorization_code:{type:"string",description:"Co\u0301digo de autorizacio\u0301n de la sub-transaccio\u0301n de pago."},payment_type_code:{type:"string",description:"Tipo de pago de la transaccio\u0301n. <br>VD = Venta De\u0301bito. <br>VN = Venta Normal. <br>VC = Venta en cuotas. <br>SI = 3 cuotas sin intere\u0301s. <br>S2 = 2 cuotas sin intere\u0301s. <br>NC = N Cuotas sin intere\u0301s <br>VP = Venta Prepago."},response_code:{type:"number",description:"Co\u0301digo de retorno del proceso de pago, donde 0 (cero) es aprobado. Valores posibles 0 = Transaccio\u0301n aprobada Puedes revisar los c\xf3digos de respuesta de rechazo en el siguiente link Algunos c\xf3digos espec\xedficos para Oneclick son -96 tbk_user no existente -97 Li\u0301mites Oneclick, ma\u0301ximo monto diario de pago excedido. -98 Li\u0301mites Oneclick, ma\u0301ximo monto de pago excedido -99 Li\u0301mites Oneclick, ma\u0301xima cantidad de pagos diarios excedido."},installments_number:{type:"number",description:"Cantidad de cuotas de la sub-transaccio\u0301n de pago."},commerce_code:{type:"string",description:"Co\u0301digo de comercio del comercio hijo (tienda).."},buy_order:{type:"string",description:"Orden de compra generada por el comercio hijo para la sub-transaccio\u0301n de pago."}}}},status:{type:"string",description:"Estado de la transacci\xf3n (INITIALIZED, AUTHORIZED, REVERSED, FAILED, NULLIFIED, PARTIALLY_NULLIFIED, CAPTURED). Largo m\xe1ximo 64"},balance:{type:"integer",description:"Monto restante de la sub-transaccio\u0301n de pago original monto inicial \u2013 monto anulado. Largo m\xe1ximo 17"}},example:{buy_order:"415034240",card_detail:{card_number:"6623"},accounting_date:"0321",transaction_date:"2019-03-21T15:43:48.523Z",details:[{amount:500,status:"AUTHORIZED",authorization_code:"1213",payment_type_code:"VN",response_code:0,installments_number:0,commerce_code:"597055555542",buy_order:"505479072"}]}}}}},400:{description:"El mensaje JSON es inv\xe1lido. Puedes ser que no corresponda a un mensaje bien estructurado o que contenga un campo no esperado",content:{"application/json":{schema:{type:"object",properties:{error_message:{type:"string",example:"token is required"}}}}}},401:{description:"No autorizado. API Key y/o API Secret inv\xe1lidos"},404:{description:"La transacci\xf3n no ha sido encontrada"},405:{description:"M\xe9todo no permitido"},406:{description:"No fue posible procesar la respuesta en el formato que el cliente indica"},415:{description:"Tipo de mensaje no permitido"},422:{description:"El requerimiento no ha podido ser procesado ya sea por validaciones de datos o por l\xf3gica de negocios"},500:{description:"Ha ocurrido un error inesperado"}},method:"post",path:"/rswebpaytransaction/api/oneclick/v1.2/transactions",servers:[{url:"https://webpay3gint.transbank.cl"}],security:[{tbkApiKeyId:[],tbkApiKeySecret:[]}],securitySchemes:{tbkApiKeyId:{type:"apiKey",name:"Tbk-Api-Key-Id",in:"header",description:"C\xf3digo de comercio"},tbkApiKeySecret:{type:"apiKey",name:"Tbk-Api-Key-Secret",in:"header",description:"LLave secreta"}},jsonRequestBodyExample:{username:"juanperez",tbk_user:"b6bd6ba3-e718-4107-9386-d2b099a8dd42",buy_order:"ordenCompra123456789",details:[{commerce_code:"597055555542",buy_order:"ordenCompra123445",amount:1e3,installments_number:5}]},info:{title:"API Oneclick Mall",description:"La modalidad de pago Oneclick permite al tarjetahabiente realizar pagos en el comercio sin la necesidad de ingresar cada vez informacio\u0301n de la tarjeta de cre\u0301dito al momento de realizar la compra. El modelo de pago contempla un proceso previo de inscripcio\u0301n o enrolamiento del tarjetahabiente, a trave\u0301s del comercio, que desee utilizar el servicio. Este tipo de pago facilita la venta, disminuye el tiempo de la transaccio\u0301n y reduce los riesgos de ingreso erro\u0301neo de los datos del medio de pago.\nEl proceso de integracio\u0301n con Oneclick consiste en desarrollar por parte del comercio las llamadas a los servicios web dispuestos por Transbank para la inscripcio\u0301n de los tarjetahabientes, asi\u0301 como para la realizacio\u0301n de los pagos.",termsOfService:"https://www.transbankdevelopers.cl/termino-y-condiciones",version:"1.0.0"},postman:{name:"Autorizar una transacci\xf3n",description:{content:'Con el tbkUser retornado de la confirmaci\xf3n (PUT /inscriptions/{token}) puedes autorizar transacciones Una vez que ya tienes la tarjeta del usuario inscrita (ya tienes el token tbk_user para ese usuario), puedes realizar cargos a esa tarjeta en cualquier momento, solo llamando a este m\xe9todo de autorizaci\xf3n, enviando el tbk_user, el username del usuario, un identificador de compra parentBuyOrder y los datos de la transacci\xf3n.\nComo Oneclick opera en modalidad Mall, en una misma autorizaci\xf3n puedes realizar varios cobros, cada uno a c\xf3digos de comercio tienda diferente. No olvidar que para realizar el cargo correctamente, esos c\xf3digo de comercio tienda deben "pertenecer" o estar asociados a tu c\xf3digo de comercio Mall cuando se contratan. Al tarjetahabiente se le realizar\xe1 un solo cobro por la suma del monto de todas las "sub-transacciones" solicitadas, pero el dinero ser\xe1 procesado y enviado a cada c\xf3digo de comercio por separado. Para aclararlo con un ejemplo, si solicito una autorizaci\xf3n por $1.500 para el comercio A, y $2.500 para el comercio B, el tarjetahabiente ver\xe1 un \xfanico cobro de $4.000 en su cartola, pero el comercio A recibir\xe1 los $1.500 y el comercio B los $2.500 (en ambos casos, restando la comisi\xf3n).\nCada "sub-transacci\xf3n" de la autorizaci\xf3n requiere de un c\xf3digo de comercio, un identificador de compra (ojal\xe1 \xfanico y diferente al identificador de compra padre), un monto y, opcionalmente, el n\xfamero de cuotas en que se realizar\xe1 el cobro.\nTip Para pruebas en el ambiente de integraci\xf3n te recomendamos crear un identificador \xfanico buy_order para cada una de las transacciones. (Ejemplo buy_order = nombre-de-mi-empresa-mall-1234, child_buy_order = nombre-de-mi-tienda-1).',type:"text/plain"},url:{path:["rswebpaytransaction","api","oneclick","v1.2","transactions"],host:["{{baseUrl}}"],query:[],variable:[]},header:[{key:"Content-Type",value:"application/json"},{key:"Accept",value:"application/json"}],method:"POST",body:{mode:"raw",raw:'""',options:{raw:{language:"json"}}}}},sidebar_class_name:"post api-method",info_path:"docs/Oneclick/api-oneclick-mall",custom_edit_url:null},p=void 0,u={unversionedId:"Oneclick/autorizar-una-transaccion",id:"Oneclick/autorizar-una-transaccion",title:"Autorizar una transacci\xf3n",description:"Con el tbkUser retornado de la confirmaci\xf3n (PUT /inscriptions/{token}) puedes autorizar transacciones Una vez que ya tienes la tarjeta del usuario inscrita (ya tienes el token tbk_user para ese usuario), puedes realizar cargos a esa tarjeta en cualquier momento, solo llamando a este m\xe9todo de autorizaci\xf3n, enviando el tbk_user, el username del usuario, un identificador de compra parentBuyOrder y los datos de la transacci\xf3n.",source:"@site/docs/Oneclick/autorizar-una-transaccion.api.mdx",sourceDirName:"Oneclick",slug:"/Oneclick/autorizar-una-transaccion",permalink:"/tbk-developers-new-site/docs/Oneclick/autorizar-una-transaccion",draft:!1,editUrl:null,tags:[],version:"current",frontMatter:{id:"autorizar-una-transaccion",title:"Autorizar una transacci\xf3n",description:"Con el tbkUser retornado de la confirmaci\xf3n (PUT /inscriptions/{token}) puedes autorizar transacciones Una vez que ya tienes la tarjeta del usuario inscrita (ya tienes el token tbk_user para ese usuario), puedes realizar cargos a esa tarjeta en cualquier momento, solo llamando a este m\xe9todo de autorizaci\xf3n, enviando el tbk_user, el username del usuario, un identificador de compra parentBuyOrder y los datos de la transacci\xf3n.",sidebar_label:"Autorizar una transacci\xf3n",hide_title:!0,hide_table_of_contents:!0,api:{tags:["Oneclick Mall"],description:'Con el tbkUser retornado de la confirmaci\xf3n (PUT /inscriptions/{token}) puedes autorizar transacciones Una vez que ya tienes la tarjeta del usuario inscrita (ya tienes el token tbk_user para ese usuario), puedes realizar cargos a esa tarjeta en cualquier momento, solo llamando a este m\xe9todo de autorizaci\xf3n, enviando el tbk_user, el username del usuario, un identificador de compra parentBuyOrder y los datos de la transacci\xf3n.\nComo Oneclick opera en modalidad Mall, en una misma autorizaci\xf3n puedes realizar varios cobros, cada uno a c\xf3digos de comercio tienda diferente. No olvidar que para realizar el cargo correctamente, esos c\xf3digo de comercio tienda deben "pertenecer" o estar asociados a tu c\xf3digo de comercio Mall cuando se contratan. Al tarjetahabiente se le realizar\xe1 un solo cobro por la suma del monto de todas las "sub-transacciones" solicitadas, pero el dinero ser\xe1 procesado y enviado a cada c\xf3digo de comercio por separado. Para aclararlo con un ejemplo, si solicito una autorizaci\xf3n por $1.500 para el comercio A, y $2.500 para el comercio B, el tarjetahabiente ver\xe1 un \xfanico cobro de $4.000 en su cartola, pero el comercio A recibir\xe1 los $1.500 y el comercio B los $2.500 (en ambos casos, restando la comisi\xf3n).\nCada "sub-transacci\xf3n" de la autorizaci\xf3n requiere de un c\xf3digo de comercio, un identificador de compra (ojal\xe1 \xfanico y diferente al identificador de compra padre), un monto y, opcionalmente, el n\xfamero de cuotas en que se realizar\xe1 el cobro.\nTip Para pruebas en el ambiente de integraci\xf3n te recomendamos crear un identificador \xfanico buy_order para cada una de las transacciones. (Ejemplo buy_order = nombre-de-mi-empresa-mall-1234, child_buy_order = nombre-de-mi-tienda-1).',requestBody:{content:{"application/json":{schema:{type:"object",properties:{username:{type:"string",description:"Identificador del usuario en los sistemas del comercio (el mismo indicado en Inscription.start()). Largo m\xe1ximo 40.",maxLength:40},tbk_user:{type:"string",description:"Identificador u\u0301nico de la inscripcio\u0301n del cliente (devuelto por Inscription.finish()). Largo 40.",minLength:40,maxLength:40},buy_order:{type:"integer",description:"Identificador u\u0301nico de la compra generado por el comercio. Largo m\xe1ximo 26."},details:{type:"array",description:"Lista de objetos, uno por cada tienda diferente del mall que participa en la transacci\xf3n.",items:{type:"object",properties:{commerce_code:{type:"string",description:"Co\u0301digo comercio asignado por Transbank para la tienda perteneciente al mall a la cual corresponde esta transacci\xf3n. Largo 12.",minLength:12,maxLength:12},buy_order:{type:"string",description:"Orden de compra de la tienda del mall. Este nu\u0301mero debe ser u\u0301nico para cada transaccio\u0301n. Largo ma\u0301ximo 26. La orden de compra puede tener Nu\u0301meros, letras, mayu\u0301sculas y minu\u0301sculas, y los signos |_=&%.,~:/?[+!@()>-.",maxLength:26},amount:{type:"number",description:"Monto de la transaccio\u0301n. Ma\u0301ximo 2 decimales para USD. Largo ma\u0301ximo 17",format:"float"},installments_number:{type:"integer",description:"Cantidad de cuotas de la transaccio\u0301n de pago. Largo 2. No obligatorio.",maximum:100}}}}},example:{username:"juanperez",tbk_user:"b6bd6ba3-e718-4107-9386-d2b099a8dd42",buy_order:"ordenCompra123456789",details:[{commerce_code:"597055555542",buy_order:"ordenCompra123445",amount:1e3,installments_number:5}]}}}},required:!0},responses:{200:{description:"(OK) La informacion de la inscripcion autorizada",content:{"application/json":{schema:{type:"object",properties:{buy_order:{type:"string",description:"Orden de compra generada por el comercio padre."},card_detail:{type:"array",description:"Objeto que contiene informaci\xf3n de la tarjeta utilizado por el tarjetahabiente.",items:{type:"object",properties:{"card_detail.card_number":{type:"string",description:"Los u\u0301ltimos 4 di\u0301gitos de la tarjeta usada en la transacci\xf3n."}}}},accounting_date:{type:"string",description:"Fecha contable de la autorizacio\u0301n del pago."},transaction_date:{type:"string",description:"Fecha completa (timestamp) de la autorizacio\u0301n del pago. Largo: 24, formato: ISO 8601 (Ej: yyyy-mm-ddTHH:mm:ss.xxxZ)"},details:{type:"array",description:"Lista con el resultado de cada transacci\xf3n de las tiendas hijas.",items:{type:"object",properties:{amount:{type:"number",description:"Monto de la sub-transaccio\u0301n de pago",format:"float"},status:{type:"string",description:"Estado de la transaccio\u0301n (INITIALIZED, AUTHORIZED, REVERSED, FAILED, NULLIFIED, PARTIALLY_NULLIFIED, CAPTURED)."},authorization_code:{type:"string",description:"Co\u0301digo de autorizacio\u0301n de la sub-transaccio\u0301n de pago."},payment_type_code:{type:"string",description:"Tipo de pago de la transaccio\u0301n. <br>VD = Venta De\u0301bito. <br>VN = Venta Normal. <br>VC = Venta en cuotas. <br>SI = 3 cuotas sin intere\u0301s. <br>S2 = 2 cuotas sin intere\u0301s. <br>NC = N Cuotas sin intere\u0301s <br>VP = Venta Prepago."},response_code:{type:"number",description:"Co\u0301digo de retorno del proceso de pago, donde 0 (cero) es aprobado. Valores posibles 0 = Transaccio\u0301n aprobada Puedes revisar los c\xf3digos de respuesta de rechazo en el siguiente link Algunos c\xf3digos espec\xedficos para Oneclick son -96 tbk_user no existente -97 Li\u0301mites Oneclick, ma\u0301ximo monto diario de pago excedido. -98 Li\u0301mites Oneclick, ma\u0301ximo monto de pago excedido -99 Li\u0301mites Oneclick, ma\u0301xima cantidad de pagos diarios excedido."},installments_number:{type:"number",description:"Cantidad de cuotas de la sub-transaccio\u0301n de pago."},commerce_code:{type:"string",description:"Co\u0301digo de comercio del comercio hijo (tienda).."},buy_order:{type:"string",description:"Orden de compra generada por el comercio hijo para la sub-transaccio\u0301n de pago."}}}},status:{type:"string",description:"Estado de la transacci\xf3n (INITIALIZED, AUTHORIZED, REVERSED, FAILED, NULLIFIED, PARTIALLY_NULLIFIED, CAPTURED). Largo m\xe1ximo 64"},balance:{type:"integer",description:"Monto restante de la sub-transaccio\u0301n de pago original monto inicial \u2013 monto anulado. Largo m\xe1ximo 17"}},example:{buy_order:"415034240",card_detail:{card_number:"6623"},accounting_date:"0321",transaction_date:"2019-03-21T15:43:48.523Z",details:[{amount:500,status:"AUTHORIZED",authorization_code:"1213",payment_type_code:"VN",response_code:0,installments_number:0,commerce_code:"597055555542",buy_order:"505479072"}]}}}}},400:{description:"El mensaje JSON es inv\xe1lido. Puedes ser que no corresponda a un mensaje bien estructurado o que contenga un campo no esperado",content:{"application/json":{schema:{type:"object",properties:{error_message:{type:"string",example:"token is required"}}}}}},401:{description:"No autorizado. API Key y/o API Secret inv\xe1lidos"},404:{description:"La transacci\xf3n no ha sido encontrada"},405:{description:"M\xe9todo no permitido"},406:{description:"No fue posible procesar la respuesta en el formato que el cliente indica"},415:{description:"Tipo de mensaje no permitido"},422:{description:"El requerimiento no ha podido ser procesado ya sea por validaciones de datos o por l\xf3gica de negocios"},500:{description:"Ha ocurrido un error inesperado"}},method:"post",path:"/rswebpaytransaction/api/oneclick/v1.2/transactions",servers:[{url:"https://webpay3gint.transbank.cl"}],security:[{tbkApiKeyId:[],tbkApiKeySecret:[]}],securitySchemes:{tbkApiKeyId:{type:"apiKey",name:"Tbk-Api-Key-Id",in:"header",description:"C\xf3digo de comercio"},tbkApiKeySecret:{type:"apiKey",name:"Tbk-Api-Key-Secret",in:"header",description:"LLave secreta"}},jsonRequestBodyExample:{username:"juanperez",tbk_user:"b6bd6ba3-e718-4107-9386-d2b099a8dd42",buy_order:"ordenCompra123456789",details:[{commerce_code:"597055555542",buy_order:"ordenCompra123445",amount:1e3,installments_number:5}]},info:{title:"API Oneclick Mall",description:"La modalidad de pago Oneclick permite al tarjetahabiente realizar pagos en el comercio sin la necesidad de ingresar cada vez informacio\u0301n de la tarjeta de cre\u0301dito al momento de realizar la compra. El modelo de pago contempla un proceso previo de inscripcio\u0301n o enrolamiento del tarjetahabiente, a trave\u0301s del comercio, que desee utilizar el servicio. Este tipo de pago facilita la venta, disminuye el tiempo de la transaccio\u0301n y reduce los riesgos de ingreso erro\u0301neo de los datos del medio de pago.\nEl proceso de integracio\u0301n con Oneclick consiste en desarrollar por parte del comercio las llamadas a los servicios web dispuestos por Transbank para la inscripcio\u0301n de los tarjetahabientes, asi\u0301 como para la realizacio\u0301n de los pagos.",termsOfService:"https://www.transbankdevelopers.cl/termino-y-condiciones",version:"1.0.0"},postman:{name:"Autorizar una transacci\xf3n",description:{content:'Con el tbkUser retornado de la confirmaci\xf3n (PUT /inscriptions/{token}) puedes autorizar transacciones Una vez que ya tienes la tarjeta del usuario inscrita (ya tienes el token tbk_user para ese usuario), puedes realizar cargos a esa tarjeta en cualquier momento, solo llamando a este m\xe9todo de autorizaci\xf3n, enviando el tbk_user, el username del usuario, un identificador de compra parentBuyOrder y los datos de la transacci\xf3n.\nComo Oneclick opera en modalidad Mall, en una misma autorizaci\xf3n puedes realizar varios cobros, cada uno a c\xf3digos de comercio tienda diferente. No olvidar que para realizar el cargo correctamente, esos c\xf3digo de comercio tienda deben "pertenecer" o estar asociados a tu c\xf3digo de comercio Mall cuando se contratan. Al tarjetahabiente se le realizar\xe1 un solo cobro por la suma del monto de todas las "sub-transacciones" solicitadas, pero el dinero ser\xe1 procesado y enviado a cada c\xf3digo de comercio por separado. Para aclararlo con un ejemplo, si solicito una autorizaci\xf3n por $1.500 para el comercio A, y $2.500 para el comercio B, el tarjetahabiente ver\xe1 un \xfanico cobro de $4.000 en su cartola, pero el comercio A recibir\xe1 los $1.500 y el comercio B los $2.500 (en ambos casos, restando la comisi\xf3n).\nCada "sub-transacci\xf3n" de la autorizaci\xf3n requiere de un c\xf3digo de comercio, un identificador de compra (ojal\xe1 \xfanico y diferente al identificador de compra padre), un monto y, opcionalmente, el n\xfamero de cuotas en que se realizar\xe1 el cobro.\nTip Para pruebas en el ambiente de integraci\xf3n te recomendamos crear un identificador \xfanico buy_order para cada una de las transacciones. (Ejemplo buy_order = nombre-de-mi-empresa-mall-1234, child_buy_order = nombre-de-mi-tienda-1).',type:"text/plain"},url:{path:["rswebpaytransaction","api","oneclick","v1.2","transactions"],host:["{{baseUrl}}"],query:[],variable:[]},header:[{key:"Content-Type",value:"application/json"},{key:"Accept",value:"application/json"}],method:"POST",body:{mode:"raw",raw:'""',options:{raw:{language:"json"}}}}},sidebar_class_name:"post api-method",info_path:"docs/Oneclick/api-oneclick-mall",custom_edit_url:null},sidebar:"tutorialSidebar",previous:{title:"Introduction",permalink:"/tbk-developers-new-site/docs/Oneclick/api-oneclick-mall"},next:{title:"Captura diferida de una transacci\xf3n",permalink:"/tbk-developers-new-site/docs/Oneclick/captura-diferida-de-una-transaccion"}},b={},y=[{value:"Autorizar una transacci\xf3n",id:"autorizar-una-transacci\xf3n",level:2}],g={toc:y};function k(e){let{components:a,...o}=e;return(0,r.kt)("wrapper",(0,i.Z)({},g,o,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"autorizar-una-transacci\xf3n"},"Autorizar una transacci\xf3n"),(0,r.kt)("p",null,'Con el tbkUser retornado de la confirmaci\xf3n (PUT /inscriptions/{token}) puedes autorizar transacciones Una vez que ya tienes la tarjeta del usuario inscrita (ya tienes el token tbk_user para ese usuario), puedes realizar cargos a esa tarjeta en cualquier momento, solo llamando a este m\xe9todo de autorizaci\xf3n, enviando el tbk_user, el username del usuario, un identificador de compra parentBuyOrder y los datos de la transacci\xf3n.\nComo Oneclick opera en modalidad Mall, en una misma autorizaci\xf3n puedes realizar varios cobros, cada uno a c\xf3digos de comercio tienda diferente. No olvidar que para realizar el cargo correctamente, esos c\xf3digo de comercio tienda deben "pertenecer" o estar asociados a tu c\xf3digo de comercio Mall cuando se contratan. Al tarjetahabiente se le realizar\xe1 un solo cobro por la suma del monto de todas las "sub-transacciones" solicitadas, pero el dinero ser\xe1 procesado y enviado a cada c\xf3digo de comercio por separado. Para aclararlo con un ejemplo, si solicito una autorizaci\xf3n por $1.500 para el comercio A, y $2.500 para el comercio B, el tarjetahabiente ver\xe1 un \xfanico cobro de $4.000 en su cartola, pero el comercio A recibir\xe1 los $1.500 y el comercio B los $2.500 (en ambos casos, restando la comisi\xf3n).\nCada "sub-transacci\xf3n" de la autorizaci\xf3n requiere de un c\xf3digo de comercio, un identificador de compra (ojal\xe1 \xfanico y diferente al identificador de compra padre), un monto y, opcionalmente, el n\xfamero de cuotas en que se realizar\xe1 el cobro.\nTip Para pruebas en el ambiente de integraci\xf3n te recomendamos crear un identificador \xfanico buy_order para cada una de las transacciones. (Ejemplo buy_order = nombre-de-mi-empresa-mall-1234, child_buy_order = nombre-de-mi-tienda-1).'),(0,r.kt)(n.Z,{mdxType:"MimeTabs"},(0,r.kt)(l.Z,{label:"application/json",value:"application/json-schema",mdxType:"TabItem"},(0,r.kt)("details",{style:{},"data-collapsed":!1,open:!0},(0,r.kt)("summary",{style:{textAlign:"left"}},(0,r.kt)("strong",null,"Request Body"),(0,r.kt)("strong",{style:{fontSize:"var(--ifm-code-font-size)",color:"var(--openapi-required)"}}," required")),(0,r.kt)("div",{style:{textAlign:"left",marginLeft:"1rem"}}),(0,r.kt)("ul",{style:{marginLeft:"1rem"}},(0,r.kt)(c.Z,{collapsible:!1,name:"username",required:!1,deprecated:void 0,schemaDescription:"Identificador del usuario en los sistemas del comercio (el mismo indicado en Inscription.start()). Largo m\xe1ximo 40.",schemaName:"string",qualifierMessage:"**Possible values:** `<= 40 characters`",defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"tbk_user",required:!1,deprecated:void 0,schemaDescription:"Identificador u\u0301nico de la inscripcio\u0301n del cliente (devuelto por Inscription.finish()). Largo 40.",schemaName:"string",qualifierMessage:"**Possible values:** `>= 40 characters` and `<= 40 characters`",defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"buy_order",required:!1,deprecated:void 0,schemaDescription:"Identificador u\u0301nico de la compra generado por el comercio. Largo m\xe1ximo 26.",schemaName:"integer",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!0,className:"schemaItem",mdxType:"SchemaItem"},(0,r.kt)("details",{style:{}},(0,r.kt)("summary",{style:{}},(0,r.kt)("strong",null,"details"),(0,r.kt)("span",{style:{opacity:"0.6"}}," object[]")),(0,r.kt)("div",{style:{marginLeft:"1rem"}},(0,r.kt)("div",{style:{marginTop:".5rem",marginBottom:".5rem"}},(0,r.kt)("p",null,"Lista de objetos, uno por cada tienda diferente del mall que participa en la transacci\xf3n.")),(0,r.kt)(c.Z,{collapsible:!1,name:"commerce_code",required:!1,deprecated:void 0,schemaDescription:"Co\u0301digo comercio asignado por Transbank para la tienda perteneciente al mall a la cual corresponde esta transacci\xf3n. Largo 12.",schemaName:"string",qualifierMessage:"**Possible values:** `>= 12 characters` and `<= 12 characters`",defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"buy_order",required:!1,deprecated:void 0,schemaDescription:"Orden de compra de la tienda del mall. Este nu\u0301mero debe ser u\u0301nico para cada transaccio\u0301n. Largo ma\u0301ximo 26. La orden de compra puede tener Nu\u0301meros, letras, mayu\u0301sculas y minu\u0301sculas, y los signos |_=&%.,~:/?[+!@()>-.",schemaName:"string",qualifierMessage:"**Possible values:** `<= 26 characters`",defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"amount",required:!1,deprecated:void 0,schemaDescription:"Monto de la transaccio\u0301n. Ma\u0301ximo 2 decimales para USD. Largo ma\u0301ximo 17",schemaName:"float",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"installments_number",required:!1,deprecated:void 0,schemaDescription:"Cantidad de cuotas de la transaccio\u0301n de pago. Largo 2. No obligatorio.",schemaName:"integer",qualifierMessage:"**Possible values:** `<= 100`",defaultValue:void 0,mdxType:"SchemaItem"})))))))),(0,r.kt)("div",null,(0,r.kt)(t.Z,{mdxType:"ApiTabs"},(0,r.kt)(l.Z,{label:"200",value:"200",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("p",null,"(OK) La informacion de la inscripcion autorizada")),(0,r.kt)("div",null,(0,r.kt)(n.Z,{schemaType:"response",mdxType:"MimeTabs"},(0,r.kt)(l.Z,{label:"application/json",value:"application/json",mdxType:"TabItem"},(0,r.kt)(d.Z,{mdxType:"SchemaTabs"},(0,r.kt)(l.Z,{label:"Schema",value:"Schema",mdxType:"TabItem"},(0,r.kt)("details",{style:{},"data-collapsed":!1,open:!0},(0,r.kt)("summary",{style:{textAlign:"left"}},(0,r.kt)("strong",null,"Schema")),(0,r.kt)("div",{style:{textAlign:"left",marginLeft:"1rem"}}),(0,r.kt)("ul",{style:{marginLeft:"1rem"}},(0,r.kt)(c.Z,{collapsible:!1,name:"buy_order",required:!1,deprecated:void 0,schemaDescription:"Orden de compra generada por el comercio padre.",schemaName:"string",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!0,className:"schemaItem",mdxType:"SchemaItem"},(0,r.kt)("details",{style:{}},(0,r.kt)("summary",{style:{}},(0,r.kt)("strong",null,"card_detail"),(0,r.kt)("span",{style:{opacity:"0.6"}}," object[]")),(0,r.kt)("div",{style:{marginLeft:"1rem"}},(0,r.kt)("div",{style:{marginTop:".5rem",marginBottom:".5rem"}},(0,r.kt)("p",null,"Objeto que contiene informaci\xf3n de la tarjeta utilizado por el tarjetahabiente.")),(0,r.kt)(c.Z,{collapsible:!1,name:"card_detail.card_number",required:!1,deprecated:void 0,schemaDescription:"Los u\u0301ltimos 4 di\u0301gitos de la tarjeta usada en la transacci\xf3n.",schemaName:"string",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"})))),(0,r.kt)(c.Z,{collapsible:!1,name:"accounting_date",required:!1,deprecated:void 0,schemaDescription:"Fecha contable de la autorizacio\u0301n del pago.",schemaName:"string",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"transaction_date",required:!1,deprecated:void 0,schemaDescription:"Fecha completa (timestamp) de la autorizacio\u0301n del pago. Largo: 24, formato: ISO 8601 (Ej: yyyy-mm-ddTHH:mm:ss.xxxZ)",schemaName:"string",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!0,className:"schemaItem",mdxType:"SchemaItem"},(0,r.kt)("details",{style:{}},(0,r.kt)("summary",{style:{}},(0,r.kt)("strong",null,"details"),(0,r.kt)("span",{style:{opacity:"0.6"}}," object[]")),(0,r.kt)("div",{style:{marginLeft:"1rem"}},(0,r.kt)("div",{style:{marginTop:".5rem",marginBottom:".5rem"}},(0,r.kt)("p",null,"Lista con el resultado de cada transacci\xf3n de las tiendas hijas.")),(0,r.kt)(c.Z,{collapsible:!1,name:"amount",required:!1,deprecated:void 0,schemaDescription:"Monto de la sub-transaccio\u0301n de pago",schemaName:"float",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"status",required:!1,deprecated:void 0,schemaDescription:"Estado de la transaccio\u0301n (INITIALIZED, AUTHORIZED, REVERSED, FAILED, NULLIFIED, PARTIALLY_NULLIFIED, CAPTURED).",schemaName:"string",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"authorization_code",required:!1,deprecated:void 0,schemaDescription:"Co\u0301digo de autorizacio\u0301n de la sub-transaccio\u0301n de pago.",schemaName:"string",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"payment_type_code",required:!1,deprecated:void 0,schemaDescription:"Tipo de pago de la transaccio\u0301n. <br>VD = Venta De\u0301bito. <br>VN = Venta Normal. <br>VC = Venta en cuotas. <br>SI = 3 cuotas sin intere\u0301s. <br>S2 = 2 cuotas sin intere\u0301s. <br>NC = N Cuotas sin intere\u0301s <br>VP = Venta Prepago.",schemaName:"string",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"response_code",required:!1,deprecated:void 0,schemaDescription:"Co\u0301digo de retorno del proceso de pago, donde 0 (cero) es aprobado. Valores posibles 0 = Transaccio\u0301n aprobada Puedes revisar los c\xf3digos de respuesta de rechazo en el siguiente link Algunos c\xf3digos espec\xedficos para Oneclick son -96 tbk_user no existente -97 Li\u0301mites Oneclick, ma\u0301ximo monto diario de pago excedido. -98 Li\u0301mites Oneclick, ma\u0301ximo monto de pago excedido -99 Li\u0301mites Oneclick, ma\u0301xima cantidad de pagos diarios excedido.",schemaName:"number",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"installments_number",required:!1,deprecated:void 0,schemaDescription:"Cantidad de cuotas de la sub-transaccio\u0301n de pago.",schemaName:"number",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"commerce_code",required:!1,deprecated:void 0,schemaDescription:"Co\u0301digo de comercio del comercio hijo (tienda)..",schemaName:"string",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"buy_order",required:!1,deprecated:void 0,schemaDescription:"Orden de compra generada por el comercio hijo para la sub-transaccio\u0301n de pago.",schemaName:"string",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"})))),(0,r.kt)(c.Z,{collapsible:!1,name:"status",required:!1,deprecated:void 0,schemaDescription:"Estado de la transacci\xf3n (INITIALIZED, AUTHORIZED, REVERSED, FAILED, NULLIFIED, PARTIALLY_NULLIFIED, CAPTURED). Largo m\xe1ximo 64",schemaName:"string",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"}),(0,r.kt)(c.Z,{collapsible:!1,name:"balance",required:!1,deprecated:void 0,schemaDescription:"Monto restante de la sub-transaccio\u0301n de pago original monto inicial \u2013 monto anulado. Largo m\xe1ximo 17",schemaName:"integer",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"})))),(0,r.kt)(l.Z,{label:"Example (from schema)",value:"Example (from schema)",mdxType:"TabItem"},(0,r.kt)(s.Z,{responseExample:'{\n  "buy_order": "415034240",\n  "card_detail": {\n    "card_number": "6623"\n  },\n  "accounting_date": "0321",\n  "transaction_date": "2019-03-21T15:43:48.523Z",\n  "details": [\n    {\n      "amount": 500,\n      "status": "AUTHORIZED",\n      "authorization_code": "1213",\n      "payment_type_code": "VN",\n      "response_code": 0,\n      "installments_number": 0,\n      "commerce_code": "597055555542",\n      "buy_order": "505479072"\n    }\n  ]\n}',language:"json",mdxType:"ResponseSamples"}))))))),(0,r.kt)(l.Z,{label:"400",value:"400",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("p",null,"El mensaje JSON es inv\xe1lido. Puedes ser que no corresponda a un mensaje bien estructurado o que contenga un campo no esperado")),(0,r.kt)("div",null,(0,r.kt)(n.Z,{schemaType:"response",mdxType:"MimeTabs"},(0,r.kt)(l.Z,{label:"application/json",value:"application/json",mdxType:"TabItem"},(0,r.kt)(d.Z,{mdxType:"SchemaTabs"},(0,r.kt)(l.Z,{label:"Schema",value:"Schema",mdxType:"TabItem"},(0,r.kt)("details",{style:{},"data-collapsed":!1,open:!0},(0,r.kt)("summary",{style:{textAlign:"left"}},(0,r.kt)("strong",null,"Schema")),(0,r.kt)("div",{style:{textAlign:"left",marginLeft:"1rem"}}),(0,r.kt)("ul",{style:{marginLeft:"1rem"}},(0,r.kt)(c.Z,{collapsible:!1,name:"error_message",required:!1,deprecated:void 0,schemaDescription:void 0,schemaName:"string",qualifierMessage:void 0,defaultValue:void 0,mdxType:"SchemaItem"})))),(0,r.kt)(l.Z,{label:"Example (from schema)",value:"Example (from schema)",mdxType:"TabItem"},(0,r.kt)(s.Z,{responseExample:'{\n  "error_message": "token is required"\n}',language:"json",mdxType:"ResponseSamples"}))))))),(0,r.kt)(l.Z,{label:"401",value:"401",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("p",null,"No autorizado. API Key y/o API Secret inv\xe1lidos")),(0,r.kt)("div",null)),(0,r.kt)(l.Z,{label:"404",value:"404",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("p",null,"La transacci\xf3n no ha sido encontrada")),(0,r.kt)("div",null)),(0,r.kt)(l.Z,{label:"405",value:"405",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("p",null,"M\xe9todo no permitido")),(0,r.kt)("div",null)),(0,r.kt)(l.Z,{label:"406",value:"406",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("p",null,"No fue posible procesar la respuesta en el formato que el cliente indica")),(0,r.kt)("div",null)),(0,r.kt)(l.Z,{label:"415",value:"415",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("p",null,"Tipo de mensaje no permitido")),(0,r.kt)("div",null)),(0,r.kt)(l.Z,{label:"422",value:"422",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("p",null,"El requerimiento no ha podido ser procesado ya sea por validaciones de datos o por l\xf3gica de negocios")),(0,r.kt)("div",null)),(0,r.kt)(l.Z,{label:"500",value:"500",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("p",null,"Ha ocurrido un error inesperado")),(0,r.kt)("div",null)))))}k.isMDXComponent=!0}}]);