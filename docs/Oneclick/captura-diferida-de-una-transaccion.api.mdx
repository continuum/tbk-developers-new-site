---
id: captura-diferida-de-una-transaccion
title: "Captura diferida de una transacción"
description: "En el caso de que tengas contratada la modalidad de Captura diferida, necesitas llamar al método capture después de llamar a authorize para finalizar la transacción.Para capturar una transacción, esta debe haber sido creada por un código de comercio configurado para captura diferida. De esa forma la transacción estará autorizada pero requerirá una captura explícita posterior para confirmar la transacción.Para realizar esa captura explícita debe usarse el método capture(). Una inscripción Oneclick Mall permite que el tarjetahabiente registre su tarjeta, asociando dicha inscripción a un comercio padre. Una vez realizada la inscripción, el comercio padre autoriza transacciones para los comercios “hijo” que tiene registrados. La autorización se encarga de validar si es posible realizar el cargo a la tarjeta de crédito, débtio o prepago realizando en el mismo acto la reserva del monto de la transacción. La posterior captura hace efectiva dicha reserva y 'captura' el monto 'reservado' previamente.Este método permite a los comercios Oneclick Mall habilitados, poder realizar capturas diferidas de una transacción previamente autorizada. El método contempla una única captura por cada autorización. Para ello se deberá indicar los datos asociados a la transacción de venta y el monto requerido para capturar, el cual debe ser menor o igual al monto originalmente autorizado. Para capturar una transacción, ésta debe haber sido creada por un código de comercio configurado para captura diferida. De esta forma la transacción estará autorizada pero requerirá una captura explícita posterior para confirmar la transacción.En esta modalidad no se aceptan tarjetas de débito ni prepago."
sidebar_label: "Captura diferida de una transacción"
hide_title: true
hide_table_of_contents: true
api: {"tags":["Oneclick Mall"],"description":"En el caso de que tengas contratada la modalidad de Captura diferida, necesitas llamar al método capture después de llamar a authorize para finalizar la transacción.Para capturar una transacción, esta debe haber sido creada por un código de comercio configurado para captura diferida. De esa forma la transacción estará autorizada pero requerirá una captura explícita posterior para confirmar la transacción.Para realizar esa captura explícita debe usarse el método capture(). Una inscripción Oneclick Mall permite que el tarjetahabiente registre su tarjeta, asociando dicha inscripción a un comercio padre. Una vez realizada la inscripción, el comercio padre autoriza transacciones para los comercios “hijo” que tiene registrados. La autorización se encarga de validar si es posible realizar el cargo a la tarjeta de crédito, débtio o prepago realizando en el mismo acto la reserva del monto de la transacción. La posterior captura hace efectiva dicha reserva y 'captura' el monto 'reservado' previamente.Este método permite a los comercios Oneclick Mall habilitados, poder realizar capturas diferidas de una transacción previamente autorizada. El método contempla una única captura por cada autorización. Para ello se deberá indicar los datos asociados a la transacción de venta y el monto requerido para capturar, el cual debe ser menor o igual al monto originalmente autorizado. Para capturar una transacción, ésta debe haber sido creada por un código de comercio configurado para captura diferida. De esta forma la transacción estará autorizada pero requerirá una captura explícita posterior para confirmar la transacción.En esta modalidad no se aceptan tarjetas de débito ni prepago.","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"commerce_code":{"type":"string","description":"Tienda hija que realizó la transacción. Largo 6.","maxLength":6},"buy_order":{"type":"string","description":"Orden de compra de la transacción que se requiere capturar. Largo máximo 26.","maxLength":26},"capture_amount":{"type":"number","description":"Monto que se desea capturar. Largo máximo 17.","format":"float"},"authorization_code":{"type":"string","description":"Código de autorización de la transacción que se requiere capturar Largo máximo 6.","maxLength":6}}}}},"required":true},"responses":{"200":{"description":"(OK) La informacion de la captura","content":{"application/json":{"schema":{"type":"object","properties":{"authorization_code":{"type":"string","description":"Código de autorización de la captura diferida. Largo máximo 6","maxLength":6},"authorization_date":{"type":"string","description":"Fecha y hora de la autorización."},"captured_amount":{"type":"number","description":"Monto capturado. Largo máximo 6","format":"float"},"response_code":{"type":"integer","description":"Código de resultado de la captura. Si es exitoso es 0,de lo contrario la captura no fue realizada. Largo máximo 2","maximum":99}},"example":{"authorization_code":"152759","authorization_date":"2020-04-03T01:49:50.181Z","captured_amount":50,"response_code":0}}}}},"400":{"description":"El mensaje JSON es inválido. Puedes ser que no corresponda a un mensaje bien estructurado o que contenga un campo no esperado","content":{"application/json":{"schema":{"type":"object","properties":{"error_message":{"type":"string","example":"token is required"}}}}}},"401":{"description":"No autorizado. API Key y/o API Secret inválidos"},"404":{"description":"La transacción no ha sido encontrada"},"405":{"description":"Método no permitido"},"406":{"description":"No fue posible procesar la respuesta en el formato que el cliente indica"},"415":{"description":"Tipo de mensaje no permitido"},"422":{"description":"El requerimiento no ha podido ser procesado ya sea por validaciones de datos o por lógica de negocios"},"500":{"description":"Ha ocurrido un error inesperado"}},"method":"put","path":"/rswebpaytransaction/api/oneclick/mall/v1.2/transactions/capture","servers":[{"url":"https://webpay3gint.transbank.cl"}],"security":[{"tbkApiKeyId":[],"tbkApiKeySecret":[]}],"securitySchemes":{"tbkApiKeyId":{"type":"apiKey","name":"Tbk-Api-Key-Id","in":"header","description":"Código de comercio"},"tbkApiKeySecret":{"type":"apiKey","name":"Tbk-Api-Key-Secret","in":"header","description":"LLave secreta"}},"jsonRequestBodyExample":{"commerce_code":"string","buy_order":"string","capture_amount":0,"authorization_code":"string"},"info":{"title":"API Oneclick Mall","description":"La modalidad de pago Oneclick permite al tarjetahabiente realizar pagos en el comercio sin la necesidad de ingresar cada vez información de la tarjeta de crédito al momento de realizar la compra. El modelo de pago contempla un proceso previo de inscripción o enrolamiento del tarjetahabiente, a través del comercio, que desee utilizar el servicio. Este tipo de pago facilita la venta, disminuye el tiempo de la transacción y reduce los riesgos de ingreso erróneo de los datos del medio de pago.\nEl proceso de integración con Oneclick consiste en desarrollar por parte del comercio las llamadas a los servicios web dispuestos por Transbank para la inscripción de los tarjetahabientes, así como para la realización de los pagos.","termsOfService":"https://www.transbankdevelopers.cl/termino-y-condiciones","version":"1.0.0"},"postman":{"name":"Captura diferida de una transacción","description":{"content":"En el caso de que tengas contratada la modalidad de Captura diferida, necesitas llamar al método capture después de llamar a authorize para finalizar la transacción.Para capturar una transacción, esta debe haber sido creada por un código de comercio configurado para captura diferida. De esa forma la transacción estará autorizada pero requerirá una captura explícita posterior para confirmar la transacción.Para realizar esa captura explícita debe usarse el método capture(). Una inscripción Oneclick Mall permite que el tarjetahabiente registre su tarjeta, asociando dicha inscripción a un comercio padre. Una vez realizada la inscripción, el comercio padre autoriza transacciones para los comercios “hijo” que tiene registrados. La autorización se encarga de validar si es posible realizar el cargo a la tarjeta de crédito, débtio o prepago realizando en el mismo acto la reserva del monto de la transacción. La posterior captura hace efectiva dicha reserva y 'captura' el monto 'reservado' previamente.Este método permite a los comercios Oneclick Mall habilitados, poder realizar capturas diferidas de una transacción previamente autorizada. El método contempla una única captura por cada autorización. Para ello se deberá indicar los datos asociados a la transacción de venta y el monto requerido para capturar, el cual debe ser menor o igual al monto originalmente autorizado. Para capturar una transacción, ésta debe haber sido creada por un código de comercio configurado para captura diferida. De esta forma la transacción estará autorizada pero requerirá una captura explícita posterior para confirmar la transacción.En esta modalidad no se aceptan tarjetas de débito ni prepago.","type":"text/plain"},"url":{"path":["rswebpaytransaction","api","oneclick","mall","v1.2","transactions","capture"],"host":["{{baseUrl}}"],"query":[],"variable":[]},"header":[{"key":"Content-Type","value":"application/json"},{"key":"Accept","value":"application/json"}],"method":"PUT","body":{"mode":"raw","raw":"\"\"","options":{"raw":{"language":"json"}}}}}
sidebar_class_name: "put api-method"
info_path: docs/Oneclick/api-oneclick-mall
custom_edit_url: null
---

import ApiTabs from "@theme/ApiTabs";
import MimeTabs from "@theme/MimeTabs";
import ParamsItem from "@theme/ParamsItem";
import ResponseSamples from "@theme/ResponseSamples";
import SchemaItem from "@theme/SchemaItem";
import SchemaTabs from "@theme/SchemaTabs";
import DiscriminatorTabs from "@theme/DiscriminatorTabs";
import TabItem from "@theme/TabItem";

## Captura diferida de una transacción



En el caso de que tengas contratada la modalidad de Captura diferida, necesitas llamar al método capture después de llamar a authorize para finalizar la transacción.Para capturar una transacción, esta debe haber sido creada por un código de comercio configurado para captura diferida. De esa forma la transacción estará autorizada pero requerirá una captura explícita posterior para confirmar la transacción.Para realizar esa captura explícita debe usarse el método capture(). Una inscripción Oneclick Mall permite que el tarjetahabiente registre su tarjeta, asociando dicha inscripción a un comercio padre. Una vez realizada la inscripción, el comercio padre autoriza transacciones para los comercios “hijo” que tiene registrados. La autorización se encarga de validar si es posible realizar el cargo a la tarjeta de crédito, débtio o prepago realizando en el mismo acto la reserva del monto de la transacción. La posterior captura hace efectiva dicha reserva y 'captura' el monto 'reservado' previamente.Este método permite a los comercios Oneclick Mall habilitados, poder realizar capturas diferidas de una transacción previamente autorizada. El método contempla una única captura por cada autorización. Para ello se deberá indicar los datos asociados a la transacción de venta y el monto requerido para capturar, el cual debe ser menor o igual al monto originalmente autorizado. Para capturar una transacción, ésta debe haber sido creada por un código de comercio configurado para captura diferida. De esta forma la transacción estará autorizada pero requerirá una captura explícita posterior para confirmar la transacción.En esta modalidad no se aceptan tarjetas de débito ni prepago.

<MimeTabs><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} data-collapsed={false} open={true}><summary style={{"textAlign":"left"}}><strong>Request Body</strong><strong style={{"fontSize":"var(--ifm-code-font-size)","color":"var(--openapi-required)"}}> required</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"commerce_code"} required={false} deprecated={undefined} schemaDescription={"Tienda hija que realizó la transacción. Largo 6."} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 6 characters`"} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"buy_order"} required={false} deprecated={undefined} schemaDescription={"Orden de compra de la transacción que se requiere capturar. Largo máximo 26."} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 26 characters`"} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"capture_amount"} required={false} deprecated={undefined} schemaDescription={"Monto que se desea capturar. Largo máximo 17."} schemaName={"float"} qualifierMessage={undefined} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"authorization_code"} required={false} deprecated={undefined} schemaDescription={"Código de autorización de la transacción que se requiere capturar Largo máximo 6."} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 6 characters`"} defaultValue={undefined}></SchemaItem></ul></details></TabItem></MimeTabs><div><ApiTabs><TabItem label={"200"} value={"200"}><div>

(OK) La informacion de la captura

</div><div><MimeTabs schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs><TabItem label={"Schema"} value={"Schema"}><details style={{}} data-collapsed={false} open={true}><summary style={{"textAlign":"left"}}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"authorization_code"} required={false} deprecated={undefined} schemaDescription={"Código de autorización de la captura diferida. Largo máximo 6"} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 6 characters`"} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"authorization_date"} required={false} deprecated={undefined} schemaDescription={"Fecha y hora de la autorización."} schemaName={"string"} qualifierMessage={undefined} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"captured_amount"} required={false} deprecated={undefined} schemaDescription={"Monto capturado. Largo máximo 6"} schemaName={"float"} qualifierMessage={undefined} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"response_code"} required={false} deprecated={undefined} schemaDescription={"Código de resultado de la captura. Si es exitoso es 0,de lo contrario la captura no fue realizada. Largo máximo 2"} schemaName={"integer"} qualifierMessage={"**Possible values:** `<= 99`"} defaultValue={undefined}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"authorization_code\": \"152759\",\n  \"authorization_date\": \"2020-04-03T01:49:50.181Z\",\n  \"captured_amount\": 50,\n  \"response_code\": 0\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"400"} value={"400"}><div>

El mensaje JSON es inválido. Puedes ser que no corresponda a un mensaje bien estructurado o que contenga un campo no esperado

</div><div><MimeTabs schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs><TabItem label={"Schema"} value={"Schema"}><details style={{}} data-collapsed={false} open={true}><summary style={{"textAlign":"left"}}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"error_message"} required={false} deprecated={undefined} schemaDescription={undefined} schemaName={"string"} qualifierMessage={undefined} defaultValue={undefined}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"error_message\": \"token is required\"\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"401"} value={"401"}><div>

No autorizado. API Key y/o API Secret inválidos

</div><div></div></TabItem><TabItem label={"404"} value={"404"}><div>

La transacción no ha sido encontrada

</div><div></div></TabItem><TabItem label={"405"} value={"405"}><div>

Método no permitido

</div><div></div></TabItem><TabItem label={"406"} value={"406"}><div>

No fue posible procesar la respuesta en el formato que el cliente indica

</div><div></div></TabItem><TabItem label={"415"} value={"415"}><div>

Tipo de mensaje no permitido

</div><div></div></TabItem><TabItem label={"422"} value={"422"}><div>

El requerimiento no ha podido ser procesado ya sea por validaciones de datos o por lógica de negocios

</div><div></div></TabItem><TabItem label={"500"} value={"500"}><div>

Ha ocurrido un error inesperado

</div><div></div></TabItem></ApiTabs></div>
      