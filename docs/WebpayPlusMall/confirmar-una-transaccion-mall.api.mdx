---
id: confirmar-una-transaccion-mall
title: "Confirmar una transacción mall"
description: "Una vez que el tarjetahabiente ha pagado, Webpay Plus retornará el control vía POST (o GET si usas la API v1.1 o posterior) a la URL que indicaste en el return_url. Recibirás también el parámetro token_ws que te permitirá conocer el resultado de la transacción. En caso de que el tarjetahabiente haya declinado, o haya ocurrido un error, recibirás la variable  TBK_TOKEN además de las variables TBK_ORDEN_COMPRA y TBK_ID_SESION."
sidebar_label: "Confirmar una transacción mall"
hide_title: true
hide_table_of_contents: true
api: {"tags":["Webpay Plus Mall"],"description":"Una vez que el tarjetahabiente ha pagado, Webpay Plus retornará el control vía POST (o GET si usas la API v1.1 o posterior) a la URL que indicaste en el return_url. Recibirás también el parámetro token_ws que te permitirá conocer el resultado de la transacción. En caso de que el tarjetahabiente haya declinado, o haya ocurrido un error, recibirás la variable  TBK_TOKEN además de las variables TBK_ORDEN_COMPRA y TBK_ID_SESION.","parameters":[{"name":"token","in":"path","required":true,"description":"Token de la transacción","schema":{"type":"string","minimum":64,"maximum":64,"example":"e9d555262db0f989e49d724b4db0b0af367cc415cde41f500a776550fc5fddd3"}}],"responses":{"200":{"description":"(OK) El resultado de la transacción","content":{"application/json":{"schema":{"type":"object","properties":{"buy_order":{"type":"string","description":"Es el código único de la orden de compra generada por el comercio mall","example":"ordenCompra12345678","maxLength":26},"session_id":{"type":"string","description":"Identificador de sesión, uso interno de comercio, este valor es devuelto al final de la transacción. Largo máximo 61","example":"sesion1234557545","maxLength":61},"card_detail":{"type":"object","description":"Objeto que representa los datos de la tarjeta de crédito del tarjeta habiente.","properties":{"card_detail.card_number":{"type":"string","description":"4 últimos números de la tarjeta de crédito del tarjetahabiente. Solo para comercios autorizados por Transbank se envía el número completo. Largo máximo 19.","minLength":4,"maxLength":19,"example":6623}}},"accounting_date":{"type":"string","description":"Fecha de la autorización. Largo 4, formato MMDD","maxLength":4,"minLength":4,"example":"MMDD"},"transaction_date":{"type":"string","description":"Fecha y hora de la autorización. Largo 24, formato ISO 8601 (Ej yyyy-mm-ddTHH:mm:ss.xxxZ)","maxLength":24,"minLength":24,"example":"yyyy-mm-ddTHH:mm:ss.xxxZ"},"vci":{"type":"string","description":"Resultado de la autenticación del tarjetahabiente. Algunos de ellos son <br>TSY - Autenticación Exitosa <br>TSN - Autenticación Rechazada <br>NP - No Participa, sin autenticación <br>U3 - Falla conexión, Autenticación Rechazada <br>INV - Datos Inválidos <br>A - Intentó <br>CNP1 - Comercio no participa <br>EOP - Error operacional <br>BNA - BIN no adherido <br>ENA - Emisor no adherido <br> <br>Para venta extranjera, estos son algunos de los códigos <br>TSYS (Autenticación exitosa Sin fricción. Resultado autenticación  Autenticación Existosa) <br>TSAS (Intento, tarjeta no enrolada / emisor no disponible. Resultado autenticación  Autenticación Exitosa) <br>TSNS (Fallido, no autenticado, denegado / no permite intentos. Resultado autenticación  Autenticación denegada) <br>TSRS (Autenticación rechazada - sin fricción. Resultado autenticación  Autenticación rechazada) <br>TSUS (Autenticación no se pudo realizar por problema técnico u otro motivo. Resultado autenticación  Autenticación fallida) <br>TSCF (Autenticación con fricción (No aceptada por el comercio). Resultado autenticación  Autenticación incompleta) <br>TSYF (Autenticación exitosa con fricción. Resultado autenticación  Autenticación exitosa) <br>TSNF (No autenticado. Transacción denegada con fricción. Resultado autenticación  Autenticación denegada) <br>TSUF (Autenticación con fricción no se pudo realizar por problema técnico u otro. Resultado autenticación  Autenticación fallida) <br>NPC (Comercio no Participa. Resultado autenticación  Comercio/BIN no participa) <br>NPB (BIN no participa. Resultado autenticación  Comercio/BIN no participa) <br>NPCB (Comercio y BIN no participan. Resultado autenticación  Comercio/BIN no participa) <br>SPCB (Comercio y BIN sí participan. Resultado autenticación  Autorización incompleta) <br>Este campo es información adicional suplementaria al responseCode pero el comercio no debe validar este campo porque constantemente se agregan nuevos mecanismos de autenticación que se traducen en nuevos valores para este campo que no están necesariamente documentados. (En el caso de tarjetas internacionales que no proveen 3D-Secure, la decisión del comercio de aceptarlas o no se realiza a nivel de configuración del comercio en Transbank y debe ser conversada con el ejecutivo del comercio)","example":"TCY"},"details":{"type":"array","items":{"type":"object","description":"Lista con resultado de cada una de las transacciones enviados en Transaction.create().","properties":{"amount":{"type":"number","description":"Formato número entero para transacciones en peso y decimal para transacciones en dólares. Largo máximo 17","format":"float","example":10000},"status":{"type":"string","description":"Estado de la transacción (INITIALIZED, AUTHORIZED, REVERSED, FAILED, NULLIFIED, PARTIALLY_NULLIFIED, CAPTURED). Largo máximo 64","maxLength":64,"example":"AUTHORIZED"},"authorization_code":{"type":"string","description":"Código de autorización de la transacción Largo máximo 6","maxLength":6,"example":1213},"payment_type_code":{"type":"string","description":"Tipo de pago de la transacción. <br>VD = Venta Débito. <br>VN = Venta Normal. <br>VC = Venta en cuotas. <br>SI = 3 cuotas sin interés. <br>S2 = 2 cuotas sin interés. <br>NC = N Cuotas sin interés <br>VP = Venta Prepago.","example":"VN"},"response_code":{"type":"number","description":"Código de respuesta de la autorización. Valores posibles <br>0 = Transacción aprobada <br>Puedes revisar los códigos de respuesta de rechazo en el siguiente <a href=\"https://www.transbankdevelopers.cl/producto/webpay#codigos-de-respuesta-de-autorizacion\">link</a>","example":0},"installments_amount":{"type":"number","description":"Monto de las cuotas. Largo máximo 17"},"installments_number":{"type":"number","description":"Cantidad de cuotas. Largo máximo 2","example":0},"commerce_code":{"type":"string","description":"Código comercio asignado por Transbank para la tienda perteneciente al mall a la cual corresponde esta transacción. Largo 12.","example":"597055555537","minLength":12,"maxLength":12},"buy_order":{"type":"string","description":"Es el código único de la orden de compra generada por el comercio mall","example":"ordenCompra12345678","maxLength":26}}}},"balance":{"type":"number","description":"Monto restante para un detalle anulado. Largo máximo 17","maximum":100000000000000000,"example":0}},"example":{"buy_order":"415034240","card_detail":{"card_number":"6623"},"accounting_date":"0321","transaction_date":"2019-03-21T15:43:48.523Z","vci":"TSY","details":[{"amount":10000,"status":"AUTHORIZED","authorization_code":"1213","payment_type_code":"VN","response_code":0,"installments_number":0,"commerce_code":"597055555536","buy_order":"505479072"}]}}}}},"400":{"description":"El mensaje JSON es inválido. Puedes ser que no corresponda a un mensaje bien estructurado o que contenga un campo no esperado","content":{"application/json":{"schema":{"type":"object","properties":{"error_message":{"type":"string","example":"token is required"}}}}}},"401":{"description":"No autorizado. API Key y/o API Secret inválidos"},"404":{"description":"La transacción no ha sido encontrada"},"405":{"description":"Método no permitido"},"406":{"description":"No fue posible procesar la respuesta en el formato que el cliente indica"},"415":{"description":"Tipo de mensaje no permitido"},"422":{"description":"El requerimiento no ha podido ser procesado ya sea por validaciones de datos o por lógica de negocios"},"500":{"description":"Ha ocurrido un error inesperado"}},"method":"put","path":"/rswebpaytransaction/api/webpay/v1.2/transactions/{token}","servers":[{"url":"https://webpay3gint.transbank.cl"}],"security":[{"tbkApiKeyId":[],"tbkApiKeySecret":[]}],"securitySchemes":{"tbkApiKeyId":{"type":"apiKey","name":"Tbk-Api-Key-Id","in":"header","description":"Código de comercio"},"tbkApiKeySecret":{"type":"apiKey","name":"Tbk-Api-Key-Secret","in":"header","description":"LLave secreta"}},"info":{"title":"API Transaccion mall - WebPay Plus Mall","description":"Una transacción Mall Normal corresponde a una solicitud de autorización financiera de un conjunto de pagos con tarjetas de crédito o débito, en donde quién realiza el pago ingresa al sitio del comercio, selecciona productos o servicios, y el ingreso asociado a los datos de la tarjeta de crédito o débito lo realiza una única vez en forma segura en Webpay para el conjunto de pagos. Cada pago tendrá su propio resultado, autorizado o rechazado. Revisa más detalles sobre esta modalidad en la documentación","termsOfService":"https://www.transbankdevelopers.cl/termino-y-condiciones","version":"1.0.0"},"postman":{"name":"Confirmar una transacción mall","description":{"content":"Una vez que el tarjetahabiente ha pagado, Webpay Plus retornará el control vía POST (o GET si usas la API v1.1 o posterior) a la URL que indicaste en el return_url. Recibirás también el parámetro token_ws que te permitirá conocer el resultado de la transacción. En caso de que el tarjetahabiente haya declinado, o haya ocurrido un error, recibirás la variable  TBK_TOKEN además de las variables TBK_ORDEN_COMPRA y TBK_ID_SESION.","type":"text/plain"},"url":{"path":["rswebpaytransaction","api","webpay","v1.2","transactions",":token"],"host":["{{baseUrl}}"],"query":[],"variable":[{"disabled":false,"description":{"content":"(Required) Token de la transacción","type":"text/plain"},"type":"any","value":"","key":"token"}]},"header":[{"key":"Accept","value":"application/json"}],"method":"PUT"}}
sidebar_class_name: "put api-method"
info_path: docs/WebpayPlusMall/api-transaccion-mall-webpay-plus-mall
custom_edit_url: null
---

import ApiTabs from "@theme/ApiTabs";
import MimeTabs from "@theme/MimeTabs";
import ParamsItem from "@theme/ParamsItem";
import ResponseSamples from "@theme/ResponseSamples";
import SchemaItem from "@theme/SchemaItem";
import SchemaTabs from "@theme/SchemaTabs";
import DiscriminatorTabs from "@theme/DiscriminatorTabs";
import TabItem from "@theme/TabItem";

## Confirmar una transacción mall



Una vez que el tarjetahabiente ha pagado, Webpay Plus retornará el control vía POST (o GET si usas la API v1.1 o posterior) a la URL que indicaste en el return_url. Recibirás también el parámetro token_ws que te permitirá conocer el resultado de la transacción. En caso de que el tarjetahabiente haya declinado, o haya ocurrido un error, recibirás la variable  TBK_TOKEN además de las variables TBK_ORDEN_COMPRA y TBK_ID_SESION.

<details style={{"marginBottom":"1rem"}} data-collapsed={false} open={true}><summary style={{}}><strong>Path Parameters</strong></summary><div><ul><ParamsItem className={"paramsItem"} param={{"name":"token","in":"path","required":true,"description":"Token de la transacción","schema":{"type":"string","minimum":64,"maximum":64,"example":"e9d555262db0f989e49d724b4db0b0af367cc415cde41f500a776550fc5fddd3"}}}></ParamsItem></ul></div></details><div><ApiTabs><TabItem label={"200"} value={"200"}><div>

(OK) El resultado de la transacción

</div><div><MimeTabs schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs><TabItem label={"Schema"} value={"Schema"}><details style={{}} data-collapsed={false} open={true}><summary style={{"textAlign":"left"}}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"buy_order"} required={false} deprecated={undefined} schemaDescription={"Es el código único de la orden de compra generada por el comercio mall"} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 26 characters`"} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"session_id"} required={false} deprecated={undefined} schemaDescription={"Identificador de sesión, uso interno de comercio, este valor es devuelto al final de la transacción. Largo máximo 61"} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 61 characters`"} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}}><summary style={{}}><strong>card_detail</strong><span style={{"opacity":"0.6"}}> object</span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

Objeto que representa los datos de la tarjeta de crédito del tarjeta habiente.

</div><SchemaItem collapsible={false} name={"card_detail.card_number"} required={false} deprecated={undefined} schemaDescription={"4 últimos números de la tarjeta de crédito del tarjetahabiente. Solo para comercios autorizados por Transbank se envía el número completo. Largo máximo 19."} schemaName={"string"} qualifierMessage={"**Possible values:** `>= 4 characters` and `<= 19 characters`"} defaultValue={undefined}></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={false} name={"accounting_date"} required={false} deprecated={undefined} schemaDescription={"Fecha de la autorización. Largo 4, formato MMDD"} schemaName={"string"} qualifierMessage={"**Possible values:** `>= 4 characters` and `<= 4 characters`"} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"transaction_date"} required={false} deprecated={undefined} schemaDescription={"Fecha y hora de la autorización. Largo 24, formato ISO 8601 (Ej yyyy-mm-ddTHH:mm:ss.xxxZ)"} schemaName={"string"} qualifierMessage={"**Possible values:** `>= 24 characters` and `<= 24 characters`"} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"vci"} required={false} deprecated={undefined} schemaDescription={"Resultado de la autenticación del tarjetahabiente. Algunos de ellos son <br>TSY - Autenticación Exitosa <br>TSN - Autenticación Rechazada <br>NP - No Participa, sin autenticación <br>U3 - Falla conexión, Autenticación Rechazada <br>INV - Datos Inválidos <br>A - Intentó <br>CNP1 - Comercio no participa <br>EOP - Error operacional <br>BNA - BIN no adherido <br>ENA - Emisor no adherido <br> <br>Para venta extranjera, estos son algunos de los códigos <br>TSYS (Autenticación exitosa Sin fricción. Resultado autenticación  Autenticación Existosa) <br>TSAS (Intento, tarjeta no enrolada / emisor no disponible. Resultado autenticación  Autenticación Exitosa) <br>TSNS (Fallido, no autenticado, denegado / no permite intentos. Resultado autenticación  Autenticación denegada) <br>TSRS (Autenticación rechazada - sin fricción. Resultado autenticación  Autenticación rechazada) <br>TSUS (Autenticación no se pudo realizar por problema técnico u otro motivo. Resultado autenticación  Autenticación fallida) <br>TSCF (Autenticación con fricción (No aceptada por el comercio). Resultado autenticación  Autenticación incompleta) <br>TSYF (Autenticación exitosa con fricción. Resultado autenticación  Autenticación exitosa) <br>TSNF (No autenticado. Transacción denegada con fricción. Resultado autenticación  Autenticación denegada) <br>TSUF (Autenticación con fricción no se pudo realizar por problema técnico u otro. Resultado autenticación  Autenticación fallida) <br>NPC (Comercio no Participa. Resultado autenticación  Comercio/BIN no participa) <br>NPB (BIN no participa. Resultado autenticación  Comercio/BIN no participa) <br>NPCB (Comercio y BIN no participan. Resultado autenticación  Comercio/BIN no participa) <br>SPCB (Comercio y BIN sí participan. Resultado autenticación  Autorización incompleta) <br>Este campo es información adicional suplementaria al responseCode pero el comercio no debe validar este campo porque constantemente se agregan nuevos mecanismos de autenticación que se traducen en nuevos valores para este campo que no están necesariamente documentados. (En el caso de tarjetas internacionales que no proveen 3D-Secure, la decisión del comercio de aceptarlas o no se realiza a nivel de configuración del comercio en Transbank y debe ser conversada con el ejecutivo del comercio)"} schemaName={"string"} qualifierMessage={undefined} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}}><summary style={{}}><strong>details</strong><span style={{"opacity":"0.6"}}> object[]</span></summary><div style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"amount"} required={false} deprecated={undefined} schemaDescription={"Formato número entero para transacciones en peso y decimal para transacciones en dólares. Largo máximo 17"} schemaName={"float"} qualifierMessage={undefined} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"status"} required={false} deprecated={undefined} schemaDescription={"Estado de la transacción (INITIALIZED, AUTHORIZED, REVERSED, FAILED, NULLIFIED, PARTIALLY_NULLIFIED, CAPTURED). Largo máximo 64"} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 64 characters`"} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"authorization_code"} required={false} deprecated={undefined} schemaDescription={"Código de autorización de la transacción Largo máximo 6"} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 6 characters`"} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"payment_type_code"} required={false} deprecated={undefined} schemaDescription={"Tipo de pago de la transacción. <br>VD = Venta Débito. <br>VN = Venta Normal. <br>VC = Venta en cuotas. <br>SI = 3 cuotas sin interés. <br>S2 = 2 cuotas sin interés. <br>NC = N Cuotas sin interés <br>VP = Venta Prepago."} schemaName={"string"} qualifierMessage={undefined} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"response_code"} required={false} deprecated={undefined} schemaDescription={"Código de respuesta de la autorización. Valores posibles <br>0 = Transacción aprobada <br>Puedes revisar los códigos de respuesta de rechazo en el siguiente <a href=\"https://www.transbankdevelopers.cl/producto/webpay#codigos-de-respuesta-de-autorizacion\">link</a>"} schemaName={"number"} qualifierMessage={undefined} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"installments_amount"} required={false} deprecated={undefined} schemaDescription={"Monto de las cuotas. Largo máximo 17"} schemaName={"number"} qualifierMessage={undefined} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"installments_number"} required={false} deprecated={undefined} schemaDescription={"Cantidad de cuotas. Largo máximo 2"} schemaName={"number"} qualifierMessage={undefined} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"commerce_code"} required={false} deprecated={undefined} schemaDescription={"Código comercio asignado por Transbank para la tienda perteneciente al mall a la cual corresponde esta transacción. Largo 12."} schemaName={"string"} qualifierMessage={"**Possible values:** `>= 12 characters` and `<= 12 characters`"} defaultValue={undefined}></SchemaItem><SchemaItem collapsible={false} name={"buy_order"} required={false} deprecated={undefined} schemaDescription={"Es el código único de la orden de compra generada por el comercio mall"} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 26 characters`"} defaultValue={undefined}></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={false} name={"balance"} required={false} deprecated={undefined} schemaDescription={"Monto restante para un detalle anulado. Largo máximo 17"} schemaName={"number"} qualifierMessage={"**Possible values:** `<= 100000000000000000`"} defaultValue={undefined}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"buy_order\": \"415034240\",\n  \"card_detail\": {\n    \"card_number\": \"6623\"\n  },\n  \"accounting_date\": \"0321\",\n  \"transaction_date\": \"2019-03-21T15:43:48.523Z\",\n  \"vci\": \"TSY\",\n  \"details\": [\n    {\n      \"amount\": 10000,\n      \"status\": \"AUTHORIZED\",\n      \"authorization_code\": \"1213\",\n      \"payment_type_code\": \"VN\",\n      \"response_code\": 0,\n      \"installments_number\": 0,\n      \"commerce_code\": \"597055555536\",\n      \"buy_order\": \"505479072\"\n    }\n  ]\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"400"} value={"400"}><div>

El mensaje JSON es inválido. Puedes ser que no corresponda a un mensaje bien estructurado o que contenga un campo no esperado

</div><div><MimeTabs schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs><TabItem label={"Schema"} value={"Schema"}><details style={{}} data-collapsed={false} open={true}><summary style={{"textAlign":"left"}}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"error_message"} required={false} deprecated={undefined} schemaDescription={undefined} schemaName={"string"} qualifierMessage={undefined} defaultValue={undefined}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"error_message\": \"token is required\"\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"401"} value={"401"}><div>

No autorizado. API Key y/o API Secret inválidos

</div><div></div></TabItem><TabItem label={"404"} value={"404"}><div>

La transacción no ha sido encontrada

</div><div></div></TabItem><TabItem label={"405"} value={"405"}><div>

Método no permitido

</div><div></div></TabItem><TabItem label={"406"} value={"406"}><div>

No fue posible procesar la respuesta en el formato que el cliente indica

</div><div></div></TabItem><TabItem label={"415"} value={"415"}><div>

Tipo de mensaje no permitido

</div><div></div></TabItem><TabItem label={"422"} value={"422"}><div>

El requerimiento no ha podido ser procesado ya sea por validaciones de datos o por lógica de negocios

</div><div></div></TabItem><TabItem label={"500"} value={"500"}><div>

Ha ocurrido un error inesperado

</div><div></div></TabItem></ApiTabs></div>
      